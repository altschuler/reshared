# Fragments

fragment ThingCard on things {
    id
    name
    description
    category
    type
    expiry
    short_id

    images {
        ...ThingImageCard
    }

    owner {
        ...UserCard
    }
}

fragment ThingImageCard on thing_images {
    id
    description
    order
    file {
        ...FileUploadCard
    }
}

fragment ThingDetails on things {
    ...ThingCard
    enabled
    group_relations {
        group {
            ...GroupCard
        }
    }
}

# Queries

query ThingList($limit: Int, $offset: Int, $orderBy: [things_order_by!], $where: things_bool_exp!) {
    things(where: $where, limit: $limit, offset: $offset, order_by: $orderBy) {
        ...ThingCard
    }

    things_aggregate(where: $where) {
        aggregate {
            count
        }
    }
}

query ThingDetails($shortId: String!) {
    things(where: { short_id: { _eq: $shortId } }) {
        ...ThingDetails
    }
}

# Mutations

mutation CreateThing($input: things_insert_input!) {
    insert_things_one(object: $input) {
        ...ThingDetails
    }
}

mutation UpdateThing($input: UpdateThingInput!) {
    updateThing(input: $input) {
        thing {
            ...ThingDetails
        }
    }
}

mutation DeleteThing($id: uuid!) {
    delete_things_by_pk(id: $id) {
        ...ThingDetails
    }
}
